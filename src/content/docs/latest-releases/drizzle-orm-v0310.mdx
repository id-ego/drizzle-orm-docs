---
title: DrizzleORM v0.31.0 ë¦´ë¦¬ìŠ¤
pubDate: 2024-05-31
description: PostgreSQL ì¸ë±ìŠ¤ API ë³€ê²½ì‚¬í•­
---

## ì£¼ìš” ë³€ê²½ì‚¬í•­

> ì°¸ê³ : `drizzle-orm@0.31.0`ì€ `drizzle-kit@0.22.0` ì´ìƒ ë²„ì „ê³¼ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Drizzle Kitë„ ë§ˆì°¬ê°€ì§€ì…ë‹ˆë‹¤. Drizzle Kit ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´ í•„ìš”í•œ ê²½ìš° ì—…ê·¸ë ˆì´ë“œë¥¼ í™•ì¸í•˜ê³  ì•ˆë‚´í•©ë‹ˆë‹¤. Drizzle Kit ì—…ë°ì´íŠ¸ëŠ” [ì•„ë˜](#drizzle-kit-updates-drizzle-kit0220)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### PostgreSQL ì¸ë±ìŠ¤ API ë³€ê²½

ì´ì „ì˜ Drizzle+PostgreSQL ì¸ë±ìŠ¤ APIëŠ” PostgreSQL ë¬¸ì„œì™€ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ì˜ëª»ëœ êµ¬ì¡°ì˜€ìŠµë‹ˆë‹¤. ë‹¤í–‰íˆë„ ì¿¼ë¦¬ì—ì„œ ì‚¬ìš©ë˜ì§€ ì•Šì•˜ê³ , drizzle-kitë„ ì¸ë±ìŠ¤ì˜ ëª¨ë“  ì†ì„±ì„ ì§€ì›í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì´ëŠ” ì´ì œ APIë¥¼ ì˜¬ë°”ë¥´ê²Œ ë³€ê²½í•˜ê³  drizzle-kitì—ì„œ ì™„ì „í•œ ì§€ì›ì„ ì œê³µí•  ìˆ˜ ìˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

ì´ì „ API

- `.on` ë‚´ë¶€ì— SQL í‘œí˜„ì‹ì„ ì •ì˜í•  ë°©ë²•ì´ ì—†ì—ˆìŠµë‹ˆë‹¤.
- `.using`ê³¼ `.on`ì´ ë™ì¼í•œ ì—­í• ì„ í–ˆê¸° ë•Œë¬¸ì— APIê°€ ì˜¬ë°”ë¥´ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
- `.asc()`, `.desc()`, `.nullsFirst()`, `.nullsLast()`ëŠ” ì¸ë±ìŠ¤ ìì²´ê°€ ì•„ë‹Œ ê° ì»¬ëŸ¼ì´ë‚˜ í‘œí˜„ì‹ì— ì§€ì •ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

```ts
// Index declaration reference
index('name')
  .on(table.column1, table.column2, ...) or .onOnly(table.column1, table.column2, ...)
  .concurrently()
  .using(sql``) // sql expression
  .asc() or .desc()
  .nullsFirst() or .nullsLast()
  .where(sql``) // sql expression
```

í˜„ì¬ API

```ts
// First example, with `.on()`
index('name')
  .on(table.column1.asc(), table.column2.nullsFirst(), ...) or .onOnly(table.column1.desc().nullsLast(), table.column2, ...)
  .concurrently()
  .where(sql``)
  .with({ fillfactor: '70' })

// Second Example, with `.using()`
index('name')
  .using('btree', table.column1.asc(), sql`lower(${table.column2})`, table.column1.op('text_ops'))
  .where(sql``) // sql expression
  .with({ fillfactor: '70' })
```

## ìƒˆë¡œìš´ ê¸°ëŠ¥

### ğŸ‰ "pg_vector" í™•ì¥ ì§€ì›

> Drizzle ìŠ¤í‚¤ë§ˆ ë‚´ì—ì„œ í™•ì¥ì„ ìƒì„±í•˜ëŠ” íŠ¹ë³„í•œ ì½”ë“œëŠ” ì—†ìŠµë‹ˆë‹¤. vector íƒ€ì…, ì¸ë±ìŠ¤, ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° `pg_vector` í™•ì¥ì´ ì„¤ì¹˜ëœ PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•œë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.

ì´ì œ `pg_vector`ìš© ì¸ë±ìŠ¤ë¥¼ ì§€ì •í•˜ê³  ì¿¼ë¦¬, ì •ë ¬ ë“±ì— `pg_vector` í•¨ìˆ˜ë¥¼ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

`pg_vector` ë¬¸ì„œì˜ ëª‡ ê°€ì§€ ì¸ë±ìŠ¤ ì˜ˆì œë¥¼ Drizzleë¡œ ë³€í™˜í•´ë³´ê² ìŠµë‹ˆë‹¤.

#### L2 ê±°ë¦¬, ë‚´ì , ì½”ì‚¬ì¸ ê±°ë¦¬

```ts
// CREATE INDEX ON items USING hnsw (embedding vector_l2_ops);
// CREATE INDEX ON items USING hnsw (embedding vector_ip_ops);
// CREATE INDEX ON items USING hnsw (embedding vector_cosine_ops);

const table = pgTable('items', {
    embedding: vector('embedding', { dimensions: 3 })
}, (table) => ({
    l2: index('l2_index').using('hnsw', table.embedding.op('vector_l2_ops'))
    ip: index('ip_index').using('hnsw', table.embedding.op('vector_ip_ops'))
    cosine: index('cosine_index').using('hnsw', table.embedding.op('vector_cosine_ops'))
}))
```

#### L1 ê±°ë¦¬, í•´ë° ê±°ë¦¬, ìì¹´ë“œ ê±°ë¦¬ - pg_vector 0.7.0 ë²„ì „ì—ì„œ ì¶”ê°€

```ts
// CREATE INDEX ON items USING hnsw (embedding vector_l1_ops);
// CREATE INDEX ON items USING hnsw (embedding bit_hamming_ops);
// CREATE INDEX ON items USING hnsw (embedding bit_jaccard_ops);

const table = pgTable('table', {
    embedding: vector('embedding', { dimensions: 3 })
}, (table) => ({
    l1: index('l1_index').using('hnsw', table.embedding.op('vector_l1_ops'))
    hamming: index('hamming_index').using('hnsw', table.embedding.op('bit_hamming_ops'))
    bit: index('bit_jaccard_index').using('hnsw', table.embedding.op('bit_jaccard_ops'))
}))
```

ì¿¼ë¦¬ì˜ ê²½ìš°, ë¯¸ë¦¬ ì •ì˜ëœ ë²¡í„° í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ SQL í…œí”Œë¦¿ ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì ì •ì˜ í•¨ìˆ˜ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¤ìŒ í—¬í¼ í•¨ìˆ˜ë“¤ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```ts
import { l2Distance, l1Distance, innerProduct, 
          cosineDistance, hammingDistance, jaccardDistance } from 'drizzle-orm'

l2Distance(table.column, [3, 1, 2]) // table.column <-> '[3, 1, 2]'
l1Distance(table.column, [3, 1, 2]) // table.column <+> '[3, 1, 2]'

innerProduct(table.column, [3, 1, 2]) // table.column <#> '[3, 1, 2]'
cosineDistance(table.column, [3, 1, 2]) // table.column <=> '[3, 1, 2]'

hammingDistance(table.column, '101') // table.column <~> '101'
jaccardDistance(table.column, '101') // table.column <%> '101'
```

`pg_vector`ì— ì‚¬ìš©í•  ë‹¤ë¥¸ í•¨ìˆ˜ê°€ ìˆë‹¤ë©´ ê¸°ì¡´ êµ¬í˜„ì„ ë³µì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```ts
export function l2Distance(
  column: SQLWrapper | AnyColumn,
  value: number[] | string[] | TypedQueryBuilder<any> | string,
): SQL {
  if (is(value, TypedQueryBuilder<any>) || typeof value === 'string') {
    return sql`${column} <-> ${value}`;
  }
  return sql`${column} <-> ${JSON.stringify(value)}`;
}
```

ì›í•˜ëŠ” ëŒ€ë¡œ ì´ë¦„ì„ ì§€ì •í•˜ê³  ì—°ì‚°ìë¥¼ ë³€ê²½í•˜ì„¸ìš”. ì´ ì˜ˆì œëŠ” ìˆ«ì ë°°ì—´, ë¬¸ìì—´ ë°°ì—´, ë¬¸ìì—´ ë˜ëŠ” select ì¿¼ë¦¬ë„ í—ˆìš©í•©ë‹ˆë‹¤. ì›í•˜ëŠ” ë‹¤ë¥¸ íƒ€ì…ì„ ììœ ë¡­ê²Œ ë§Œë“¤ê±°ë‚˜ PRì„ ì œì¶œí•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

#### ì˜ˆì œ

`pg_vector` ë¬¸ì„œì˜ ëª‡ ê°€ì§€ ì¿¼ë¦¬ ì˜ˆì œë¥¼ Drizzleë¡œ ë³€í™˜í•´ë³´ê² ìŠµë‹ˆë‹¤:

```ts
import { l2Distance } from 'drizzle-orm';

// SELECT * FROM items ORDER BY embedding <-> '[3,1,2]' LIMIT 5;
db.select().from(items).orderBy(l2Distance(items.embedding, [3,1,2]))

// SELECT embedding <-> '[3,1,2]' AS distance FROM items;
db.select({ distance: l2Distance(items.embedding, [3,1,2]) })

// SELECT * FROM items ORDER BY embedding <-> (SELECT embedding FROM items WHERE id = 1) LIMIT 5;
const subquery = db.select({ embedding: items.embedding }).from(items).where(eq(items.id, 1));
db.select().from(items).orderBy(l2Distance(items.embedding, subquery)).limit(5)

// SELECT (embedding <#> '[3,1,2]') * -1 AS inner_product FROM items;
db.select({ innerProduct: sql`(${maxInnerProduct(items.embedding, [3,1,2])}) * -1` }).from(items)

// and more!
```

## ğŸ‰ ìƒˆë¡œìš´ PostgreSQL íƒ€ì…: `point`, `line`

ì´ì œ [PostgreSQL Geometric Types](https://www.postgresql.org/docs/current/datatype-geometric.html)ì˜ `point`ì™€ `line`ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

`point` íƒ€ì…ì€ ë°ì´í„°ë² ì´ìŠ¤ ë§¤í•‘ì„ ìœ„í•œ 2ê°€ì§€ ëª¨ë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤: `tuple`ê³¼ `xy`.

- `tuple`ì€ ì‚½ì… ì‹œ í—ˆìš©ë˜ë©° ì¡°íšŒ ì‹œ íŠœí”Œë¡œ ë§¤í•‘ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ë°ì´í„°ë² ì´ìŠ¤ì˜ Point(1,2)ëŠ” drizzleì—ì„œ [1,2]ë¡œ íƒ€ì…ì´ ì§€ì •ë©ë‹ˆë‹¤.

- `xy`ëŠ” ì‚½ì… ì‹œ í—ˆìš©ë˜ë©° ì¡°íšŒ ì‹œ x, y ì¢Œí‘œë¥¼ ê°€ì§„ ê°ì²´ë¡œ ë§¤í•‘ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ë°ì´í„°ë² ì´ìŠ¤ì˜ Point(1,2)ëŠ” drizzleì—ì„œ `{ x: 1, y: 2 }`ë¡œ íƒ€ì…ì´ ì§€ì •ë©ë‹ˆë‹¤.

```ts
const items = pgTable('items', {
 point: point('point'),
 pointObj: point('point_xy', { mode: 'xy' }),
});
```

`line` íƒ€ì…ì€ ë°ì´í„°ë² ì´ìŠ¤ ë§¤í•‘ì„ ìœ„í•œ 2ê°€ì§€ ëª¨ë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤: `tuple`ê³¼ `abc`.

- `tuple`ì€ ì‚½ì… ì‹œ í—ˆìš©ë˜ë©° ì¡°íšŒ ì‹œ íŠœí”Œë¡œ ë§¤í•‘ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ë°ì´í„°ë² ì´ìŠ¤ì˜ Line{1,2,3}ì€ drizzleì—ì„œ [1,2,3]ìœ¼ë¡œ íƒ€ì…ì´ ì§€ì •ë©ë‹ˆë‹¤.

- `abc`ëŠ” ì‚½ì… ì‹œ í—ˆìš©ë˜ë©° ì¡°íšŒ ì‹œ `Ax + By + C = 0` ë°©ì •ì‹ì˜ a, b, c ìƒìˆ˜ë¥¼ ê°€ì§„ ê°ì²´ë¡œ ë§¤í•‘ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ë°ì´í„°ë² ì´ìŠ¤ì˜ Line{1,2,3}ì€ drizzleì—ì„œ `{ a: 1, b: 2, c: 3 }`ìœ¼ë¡œ íƒ€ì…ì´ ì§€ì •ë©ë‹ˆë‹¤.

```ts
const items = pgTable('items', {
 line: line('line'),
 lineObj: line('line_abc', { mode: 'abc' }),
});
```

## ğŸ‰ ê¸°ë³¸ "postgis" í™•ì¥ ì§€ì›

> Drizzle ìŠ¤í‚¤ë§ˆ ë‚´ì—ì„œ í™•ì¥ì„ ìƒì„±í•˜ëŠ” íŠ¹ë³„í•œ ì½”ë“œëŠ” ì—†ìŠµë‹ˆë‹¤. postgis íƒ€ì…, ì¸ë±ìŠ¤, ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° `postgis` í™•ì¥ì´ ì„¤ì¹˜ëœ PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•œë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.

postgis í™•ì¥ì˜ `geometry` íƒ€ì…:

```ts
const items = pgTable('items', {
  geo: geometry('geo', { type: 'point' }),
  geoObj: geometry('geo_obj', { type: 'point', mode: 'xy' }),
  geoSrid: geometry('geo_options', { type: 'point', mode: 'xy', srid: 4000 }),
});
```

**mode**
`geometry` íƒ€ì…ì€ ë°ì´í„°ë² ì´ìŠ¤ ë§¤í•‘ì„ ìœ„í•œ 2ê°€ì§€ ëª¨ë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤: `tuple`ê³¼ `xy`.

- `tuple`ì€ ì‚½ì… ì‹œ í—ˆìš©ë˜ë©° ì¡°íšŒ ì‹œ íŠœí”Œë¡œ ë§¤í•‘ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ë°ì´í„°ë² ì´ìŠ¤ì˜ geometryëŠ” drizzleì—ì„œ [1,2]ë¡œ íƒ€ì…ì´ ì§€ì •ë©ë‹ˆë‹¤.
- `xy`ëŠ” ì‚½ì… ì‹œ í—ˆìš©ë˜ë©° ì¡°íšŒ ì‹œ x, y ì¢Œí‘œë¥¼ ê°€ì§„ ê°ì²´ë¡œ ë§¤í•‘ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ë°ì´í„°ë² ì´ìŠ¤ì˜ geometryëŠ” drizzleì—ì„œ `{ x: 1, y: 2 }`ë¡œ íƒ€ì…ì´ ì§€ì •ë©ë‹ˆë‹¤.

**type**

í˜„ì¬ ë¦´ë¦¬ìŠ¤ì—ëŠ” ë¯¸ë¦¬ ì •ì˜ëœ `point` íƒ€ì…ì´ ìˆìœ¼ë©°, ì´ëŠ” PostgreSQL PostGIS í™•ì¥ì˜ `geometry(Point)` íƒ€ì…ì…ë‹ˆë‹¤. ë‹¤ë¥¸ íƒ€ì…ì„ ì‚¬ìš©í•˜ë ¤ë©´ ì›í•˜ëŠ” ë¬¸ìì—´ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

# Drizzle Kit ì—…ë°ì´íŠ¸: `drizzle-kit@0.22.0`

> ì—¬ê¸°ì˜ ë¦´ë¦¬ìŠ¤ ë…¸íŠ¸ëŠ” [drizzle-kit@0.22.0](https://github.com/drizzle-team/drizzle-kit-mirror/releases/tag/v0.22.0)ì—ì„œ ë¶€ë¶„ì ìœ¼ë¡œ ë³µì œë˜ì—ˆìŠµë‹ˆë‹¤.

## ìƒˆë¡œìš´ ê¸°ëŠ¥

### ğŸ‰ ìƒˆë¡œìš´ íƒ€ì… ì§€ì›

Drizzle Kitì€ ì´ì œ ë‹¤ìŒì„ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- PostgreSQLì˜ `point`ì™€ `line`
- PostgreSQL `pg_vector` í™•ì¥ì˜ `vector`
- PostgreSQL `PostGIS` í™•ì¥ì˜ `geometry`

### ğŸ‰ drizzle.configì˜ ìƒˆë¡œìš´ íŒŒë¼ë¯¸í„° - `extensionsFilters`

PostGIS í™•ì¥ì€ `public` ìŠ¤í‚¤ë§ˆì— ëª‡ ê°€ì§€ ë‚´ë¶€ í…Œì´ë¸”ì„ ìƒì„±í•©ë‹ˆë‹¤. ì´ëŠ” PostGIS í™•ì¥ì´ ì„¤ì¹˜ëœ ë°ì´í„°ë² ì´ìŠ¤ê°€ ìˆê³  `push` ë˜ëŠ” `introspect`ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, í•´ë‹¹ í…Œì´ë¸”ë“¤ì´ ëª¨ë‘ `diff` ì‘ì—…ì— í¬í•¨ëœë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ì´ ê²½ìš° `tablesFilter`ë¥¼ ì§€ì •í•˜ê³  í™•ì¥ì—ì„œ ìƒì„±ëœ ëª¨ë“  í…Œì´ë¸”ì„ ì°¾ì•„ì„œ ì´ íŒŒë¼ë¯¸í„°ì— ë‚˜ì—´í•´ì•¼ í•©ë‹ˆë‹¤.

ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ì—¬ ì´ëŸ¬í•œ ë‹¨ê³„ë¥¼ ìˆ˜í–‰í•  í•„ìš”ê°€ ì—†ë„ë¡ í–ˆìŠµë‹ˆë‹¤. ì‚¬ìš©ëœ í™•ì¥ì˜ ì´ë¦„ìœ¼ë¡œ `extensionsFilters`ë¥¼ ì§€ì •í•˜ê¸°ë§Œ í•˜ë©´ Drizzleì´ í•„ìš”í•œ ëª¨ë“  í…Œì´ë¸”ì„ ê±´ë„ˆëœë‹ˆë‹¤.

í˜„ì¬ëŠ” `postgis` ì˜µì…˜ë§Œ ì§€ì›í•˜ì§€ë§Œ, `public` ìŠ¤í‚¤ë§ˆì— í…Œì´ë¸”ì„ ìƒì„±í•˜ëŠ” í™•ì¥ì´ ìˆë‹¤ë©´ ë” ë§ì€ í™•ì¥ì„ ì¶”ê°€í•  ê³„íšì…ë‹ˆë‹¤.

`postgis` ì˜µì…˜ì€ `geography_columns`, `geometry_columns`, `spatial_ref_sys` í…Œì´ë¸”ì„ ê±´ë„ˆëœë‹ˆë‹¤.
```ts
import { defineConfig } from 'drizzle-kit'

export default defaultConfig({
  dialect: "postgresql",
  extensionsFilters: ["postgis"],
})
```

## ê°œì„ ì‚¬í•­

### ë°ì´í„°ë² ì´ìŠ¤ ì¸ì¦ ì •ë³´ë¥¼ ìœ„í•œ zod ìŠ¤í‚¤ë§ˆ ì—…ë°ì´íŠ¸ ë° ëª¨ë“  ê¸ì •/ë¶€ì • ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸ ì‘ì„±

- kit configì—ì„œ ì „ì²´ SSL íŒŒë¼ë¯¸í„° ì„¸íŠ¸ ì§€ì›, node:tls ì—°ê²°ì—ì„œ íƒ€ì… ì œê³µ

```ts
import { defineConfig } from 'drizzle-kit'

export default defaultConfig({
  dialect: "postgresql",
  dbCredentials: {
    ssl: true, //"require" | "allow" | "prefer" | "verify-full" | options from node:tls
  }
})
```

```ts
import { defineConfig } from 'drizzle-kit'

export default defaultConfig({
  dialect: "mysql",
  dbCredentials: {
    ssl: "", // string | SslOptions (ssl options from mysql2 package)
  }
})
```

### `libsql` ë° `better-sqlite3` ë“œë¼ì´ë²„ë¥¼ ìœ„í•œ ì •ê·œí™”ëœ SQLite URL

ì´ëŸ¬í•œ ë“œë¼ì´ë²„ëŠ” ì„œë¡œ ë‹¤ë¥¸ íŒŒì¼ ê²½ë¡œ íŒ¨í„´ì„ ê°€ì§€ê³  ìˆìœ¼ë©°, Drizzle Kitì€ ë‘˜ ë‹¤ í—ˆìš©í•˜ê³  ê°ê°ì— ëŒ€í•´ ì ì ˆí•œ íŒŒì¼ ê²½ë¡œ í˜•ì‹ì„ ìƒì„±í•©ë‹ˆë‹¤.

### MySQL ë° SQLite ì¸ë±ìŠ¤ í‘œí˜„ì‹ ë™ì‘ ì—…ë°ì´íŠ¸

ì´ë²ˆ ë¦´ë¦¬ìŠ¤ì—ì„œ MySQLê³¼ SQLiteëŠ” í‘œí˜„ì‹ì„ SQL ì¿¼ë¦¬ë¡œ ì˜¬ë°”ë¥´ê²Œ ë§¤í•‘í•©ë‹ˆë‹¤. í‘œí˜„ì‹ì€ ë¬¸ìì—´ì—ì„œ ì´ìŠ¤ì¼€ì´í”„ë˜ì§€ ì•Šì§€ë§Œ ì»¬ëŸ¼ì€ ì´ìŠ¤ì¼€ì´í”„ë©ë‹ˆë‹¤.

```ts
export const users = sqliteTable(
  'users',
  {
    id: integer('id').primaryKey(),
    email: text('email').notNull(),
  },
  (table) => ({
    emailUniqueIndex: uniqueIndex('emailUniqueIndex').on(sql`lower(${table.email})`),
  }),
);

```
```sql
-- before
CREATE UNIQUE INDEX `emailUniqueIndex` ON `users` (`lower("users"."email")`);

-- now
CREATE UNIQUE INDEX `emailUniqueIndex` ON `users` (lower("email"));
```

## ë²„ê·¸ ìˆ˜ì •

- [BUG]: ì—¬ëŸ¬ ì œì•½ì¡°ê±´ì´ ì¶”ê°€ë˜ì§€ ì•ŠìŒ (ì²« ë²ˆì§¸ ê²ƒë§Œ ìƒì„±ë¨) - [#2341](https://github.com/drizzle-team/drizzle-orm/issues/2341)
- Drizzle Studio: Error: Connection terminated unexpectedly - [#435](https://github.com/drizzle-team/drizzle-kit-mirror/issues/435)
- SQLite ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ë¡œì»¬ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ì—†ìŒ - [#432](https://github.com/drizzle-team/drizzle-kit-mirror/issues/432)
- error: unknown option '--config' - [#423](https://github.com/drizzle-team/drizzle-kit-mirror/issues/423)


## ì¸ë±ìŠ¤ì— ëŒ€í•œ `push` ë° `generate` ì‘ë™ ë°©ì‹

### ì œí•œì‚¬í•­

#### í•˜ë‚˜ ì´ìƒì˜ í‘œí˜„ì‹ì— ì¸ë±ìŠ¤ê°€ ìˆëŠ” ê²½ìš° ì¸ë±ìŠ¤ ì´ë¦„ì„ ìˆ˜ë™ìœ¼ë¡œ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤

ì˜ˆì œ

```ts
index().on(table.id, table.email) // will work well and name will be autogeneretaed
index('my_name').on(table.id, table.email) // will work well

// but

index().on(sql`lower(${table.email})`) // error
index('my_name').on(sql`lower(${table.email})`) // will work well
```

#### ê¸°ì¡´ ì¸ë±ìŠ¤ì—ì„œ ë‹¤ìŒ í•„ë“œ(ì•„ë˜ ëª©ë¡)ê°€ ë³€ê²½ëœ ê²½ìš° PushëŠ” ë¬¸ì„ ìƒì„±í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤:

- `.on()` ë° `.using()` ë‚´ë¶€ì˜ í‘œí˜„ì‹
- `.where()` ë¬¸
- ì»¬ëŸ¼ì˜ ì—°ì‚°ì í´ë˜ìŠ¤ `.op()`

`push` ì›Œí¬í”Œë¡œìš°ë¥¼ ì‚¬ìš©í•˜ê³  ì¸ë±ìŠ¤ì—ì„œ ì´ëŸ¬í•œ í•„ë“œë¥¼ ë³€ê²½í•˜ë ¤ëŠ” ê²½ìš° ë‹¤ìŒì„ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤:

- ì¸ë±ìŠ¤ë¥¼ ì£¼ì„ ì²˜ë¦¬
- Push ì‹¤í–‰
- ì¸ë±ìŠ¤ ì£¼ì„ì„ í•´ì œí•˜ê³  í•´ë‹¹ í•„ë“œ ë³€ê²½
- ë‹¤ì‹œ Push ì‹¤í–‰

`generate` ëª…ë ¹ì˜ ê²½ìš°, `drizzle-kit`ì€ ìƒˆë¡œìš´ drizzle ì¸ë±ìŠ¤ APIì˜ ëª¨ë“  ì†ì„±ì— ëŒ€í•œ ì¸ë±ìŠ¤ ë³€ê²½ ì‚¬í•­ì— ì˜í•´ íŠ¸ë¦¬ê±°ë˜ë¯€ë¡œ ì—¬ê¸°ì—ëŠ” ì œí•œì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.
