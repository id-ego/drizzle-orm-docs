---
title: DrizzleORM v0.16.2 ë¦´ë¦¬ìŠ¤
pubDate: 2023-01-21
description: Drizzle ORMì€ ì¿¼ë¦¬ ë¹Œë”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, SQL ìŠ¤í‚¤ë§ˆì˜ ë‹¨ì¼ ì†ŒìŠ¤(source of truth)ì´ì ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒì„±ì„ ìœ„í•œ CLIë¥¼ ì œê³µí•˜ëŠ” ê´€ìš©ì  TypeScript ORMì…ë‹ˆë‹¤.
---
import Section from "@mdx/Section.astro";

Drizzle ORMì€ ì¿¼ë¦¬ ë¹Œë”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, SQL ìŠ¤í‚¤ë§ˆì˜ ë‹¨ì¼ ì†ŒìŠ¤(source of truth)ì´ì ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒì„±ì„ ìœ„í•œ CLIë¥¼ ì œê³µí•˜ëŠ” ê´€ìš©ì  TypeScript ORMì…ë‹ˆë‹¤.

ì§€ë‚œ ì£¼ìš” ì—…ë°ì´íŠ¸ ì´í›„ ë§ì€ ìš”ì²­ëœ ê¸°ëŠ¥ë“¤ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤ ğŸš€

### ğŸ‰ PostgreSQL ìŠ¤í‚¤ë§ˆ

ì´ì œ [PostgreSQL ìŠ¤í‚¤ë§ˆ](https://www.postgresql.org/docs/current/ddl-schemas.html)ë¥¼ ì„ ì–¸í•˜ê³  í•´ë‹¹ ìŠ¤í‚¤ë§ˆ ë‚´ì— ìƒì„±í•  í…Œì´ë¸”ì„ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

<Section>
```ts copy
// src/schema.ts
import { pgSchema } from "drizzle-orm-pg";

export const mySchema = pgSchema("my_schema");

export const users = mySchema("users", {
  id: serial("id").primaryKey(),
  name: text("name"),
  email: text("email"),
});
```
```sql
CREATE SCHEMA "my_schema";

CREATE TABLE IF NOT EXISTS "my_schema"."users" (
	"id" serial PRIMARY KEY NOT NULL,
	"name" text,
	"email" text
);
```
</Section>

[drizzle-kit](https://driz.link/kit)ì´ í•„ìš”í•œ ëª¨ë“  SQL ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤

 ```shell
drizzle-kit generate:pg --schema=src/schema.ts --out=migrations/
 ```

### ğŸ‰ MySQL ë°ì´í„°ë² ì´ìŠ¤/ìŠ¤í‚¤ë§ˆ

ì´ì œ [MySQL ë°ì´í„°ë² ì´ìŠ¤/ìŠ¤í‚¤ë§ˆ](https://dev.mysql.com/doc/refman/8.0/en/create-database.html)ë¥¼ ì„ ì–¸í•˜ê³  ê·¸ ì•ˆì— ìƒì„±í•  í…Œì´ë¸”ì„ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

```ts copy
// schema.ts
import { mysqlSchema } from "drizzle-orm-mysql";

const mySchema = mysqlSchema("my_schema");

const users = mySchema("users", {
  id: serial("id").primaryKey(),
  name: text("name"),
  email: text("email"),
});
```

[drizzle-kit](https://driz.link/kit)ì´ í•„ìš”í•œ ëª¨ë“  SQL ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤ ```shell drizzle-kit
generate:mysql --schema=src/schema.ts --out=migrations/ ```

ê·¸ëŸ¬ë©´ ë‹¤ìŒê³¼ ê°™ì€ SQL ë§ˆì´ê·¸ë ˆì´ì…˜ì´ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤

```sql
CREATE DATABASE `my_schema`;

CREATE TABLE `my_schema`.`users` (
	`id` serial PRIMARY KEY NOT NULL,
	`name` text,
	`email` text
);
```

### ğŸ‰ PostgreSQL ì¸íŠ¸ë¡œìŠ¤í™íŠ¸

ì´ì œ [drizzle-kit](https://driz.link/kit)ì„ ì‚¬ìš©í•˜ì—¬ ê¸°ì¡´ PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ëª‡ ì´ˆ ë§Œì— ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ê¸°ì¡´ ORMì´ë‚˜ ë°”ë‹ë¼ SQLì—ì„œ ì „í™˜í•˜ëŠ” ë° ë”°ë¥´ëŠ” ëŒ€ë¶€ë¶„ì˜ ì–´ë ¤ì›€ì´ ì‚¬ë¼ì§‘ë‹ˆë‹¤.
ì§€ì› í•­ëª©:

- enum
- ëª¨ë“  ë„¤ì´í‹°ë¸Œ ë° ë¹„ë„¤ì´í‹°ë¸Œ ì»¬ëŸ¼ì„ ê°€ì§„ í…Œì´ë¸”
- ì¸ë±ìŠ¤
- ì™¸ë˜ í‚¤, ìê¸° ì°¸ì¡° ë° ìˆœí™˜ ì™¸ë˜ í‚¤
- ìŠ¤í‚¤ë§ˆ

```shell
drizzle-kit introspect:pg --out=migrations/ --connectionString=postgresql://user:pass@host:port/db_name
```

ë‹¤ìŒê³¼ ê°™ì€ `schema.ts`ê°€ ìƒì„±ë©ë‹ˆë‹¤

```ts copy
export const myEnum = pgEnum("my_enum", ["one", "two", "three"]);
export const mySchema = pgSchema("my_schema");

export const users = mySchema("users", {
  id: serial("id").primaryKey(),
  name: text("name"),
  email: text("email"),
});

export const users2 = pgTable("users2", {
  id: serial("id").primaryKey(),
  name: varchar("name2"),
  enum: myEnum("enum"),
});

export const allColumns = pgTable("all_columns", {
  sm: smallint("smallint"),
  smdef: smallint("smallint_def").default(10),
  int: integer("integer"),
  intdef: integer("integer_def").default(10),
  numeric: numeric("numeric"),
  numeric2: numeric("numeric2", { precision: 7 }),
  numeric3: numeric("numeric3", { scale: 7 }),
  numeric4: numeric("numeric4", { precision: 7, scale: 7 }),
  numericdef: numeric("numeridef").default("100"),
  bigint: bigint("bigint", { mode: "number" }),
  bigintdef: bigint("bigint", { mode: "number" }).default(100),
  bool: boolean("boolean"),
  booldef: boolean("boolean_def").default(true),
  text: text("text"),
  textdef: text("textdef").default("text"),
  varchar: varchar("varchar"),
  varchardef: varchar("varchardef").default("text"),
  serial: serial("serial"),
  bigserial: bigserial("bigserial", { mode: "bigint" }),
  decimal: decimal("decimal", { precision: 100, scale: 2 }),
  decimaldef: decimal("decimaldef", { precision: 100, scale: 2 }).default(
    "100.0",
  ),
  doublePrecision: doublePrecision("decimal"),
  doublePrecisiondef: doublePrecision("decimaldef").default(100.0),
  real: real("real"),
  realdef: real("decimaldef").default(100.0),
  json: json<{ attr: string }>("json"),
  jsondef: json<{ attr: string }>("jsondef").default({ attr: "value" }),
  jsonb: jsonb<{ attr: string }>("jsonb"),
  jsonbdef: jsonb<{ attr: string }>("jsonbdef").default({ attr: "value" }),
  time: time("time"),
  time2: time("time2", { precision: 6, withTimezone: true }),
  timedefnow: time("timedefnow").defaultNow(),
  timestamp: timestamp("timestamp"),
  timestamp2: timestamp("timestamp2", { precision: 6, withTimezone: true }),
  timestamp3: timestamp("timestamp3", { withTimezone: true }),
  timestamp4: timestamp("timestamp4", { precision: 4 }),
  timestampdef: timestamp("timestampdef").defaultNow(),
  date: date("date", { mode: "date" }),
  datedef: date("datedef").defaultNow(),
  interval: interval("interval"),
  intervaldef: interval("intervaldef").default("10 days"),
});

export const cyclic1 = pgTable("cyclic1", {
  id: serial("id").primaryKey(),
  ext2: integer("ext2").references(() => cyclic2.id),
});

export const cyclic2 = pgTable("cyclic2", {
  id: serial("id").primaryKey(),
  ext1: integer("ext1").references((): AnyPgColumn => cyclic1.id),
});

export const example = pgTable(
  "example",
  {
    id: serial("id").primaryKey(),
    reportsTo: integer("reports_to"),
  },
  (table) => {
    return {
      reportsToFK: foreignKey({
        columns: [table.reportsTo],
        foreignColumns: [table.id],
      }),
    };
  },
);
```

### ğŸ‰ Postgres.js ë“œë¼ì´ë²„ ì§€ì›

[postgres.js](https://github.com/porsager/postgres)ì— ëŒ€í•œ ì™„ì „í•œ ì§€ì›ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. ê°€ë³ê³  ë¹ ë¦…ë‹ˆë‹¤ ğŸš€

```ts copy
// schema.ts
import { pgTable, serial, text, varchar } from "drizzle-orm-pg";
export const users = pgTable("users", {
  id: serial("id").primaryKey(),
  fullName: text("full_name"),
  phone: varchar("phone", { length: 256 }),
});

// index.ts
import { drizzle, PostgresJsDatabase } from "drizzle-orm-pg/postgres.js";
import postgres from "postgres";
import { users } from "./schema";

const client = postgres(connectionString);
const db: PostgresJsDatabase = drizzle(client);

const allUsers = await db.select(users);
```

ì „ì²´ PostgreSQL ë¬¸ì„œëŠ” [ì—¬ê¸°](https://github.com/drizzle-team/drizzle-orm/tree/main/drizzle-orm-pg)ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”

### ğŸ‰ PostgreSQL ë° MySQL íƒ€ì…

í•„ìš”í•œ ë¹„ë„¤ì´í‹°ë¸Œ PostgreSQL ë˜ëŠ” MySQL íƒ€ì…ì„ ìƒì„±í•  ìˆ˜ ìˆëŠ” ìœ ìš©í•œ ì—°ì‚°ìë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤

```ts copy
// PostgreSQL
const customText = customType<{ data: string }>({
  dataType() {
    return "text";
  },
});

const usersTable = pgTable("users", {
  name: customText("name").notNull(),
});

// MySQL
const customText = customType<{ data: string }>({
  dataType() {
    return "text";
  },
});

const usersTable = mysqlTable("users", {
  name: customText("name").notNull(),
});
```
